<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é‡‘å¹£è¿·å®®ï½œéš¨æ©Ÿ vs è²ªå©ª</title>
  <style>
    :root{
      --cell: 64px;
      --gap: 8px;
      --bg: #0b1220;
      --text: #eaf0ff;
      --muted: #a9b7e6;
      --good: #3ddc97;
      --bad: #ff6b6b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 14px;
      font-family: system-ui, -apple-system, "Segoe UI", "Noto Sans TC", "PingFang TC", Arial, sans-serif;
    }
    body{
      margin:0; background: radial-gradient(1200px 800px at 20% 10%, #17244a 0%, var(--bg) 55%);
      color: var(--text);
    }
    .wrap{
      max-width: 1000px;
      margin: 24px auto;
      padding: 16px;
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 16px;
    }
    @media (max-width: 900px){
      .wrap{ grid-template-columns: 1fr; }
    }
    .panel, .side{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.08);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      backdrop-filter: blur(6px);
    }
    h1{
      font-size: 18px; margin: 0 0 10px 0;
      display:flex; align-items:center; gap:10px;
    }
    .tag{
      font-size: 12px; color: var(--muted);
      border:1px solid rgba(255,255,255,.15);
      padding: 2px 8px; border-radius: 999px;
    }

    /* grid */
    .grid{
      display: grid;
      grid-template-columns: repeat(7, var(--cell)); /* 7x7ï¼šè‹¥è¦ 8x8 æ”¹ repeat(8, var(--cell)) */
      grid-auto-rows: var(--cell);
      gap: var(--gap);
      justify-content: center;
      padding: 10px;
      background: rgba(0,0,0,.12);
      border-radius: var(--radius);
      border: 1px solid rgba(255,255,255,.06);
    }
    .cell{
      position: relative;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.08);
      overflow: hidden;
      user-select: none;
    }
    .cell .coin{
      position:absolute; left:8px; top:8px;
      font-weight: 700;
      font-size: 14px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
    }
    .coin.good{ color: var(--good); }
    .coin.bad{ color: var(--bad); }
    .coin.zero{ color: var(--muted); }

    .cell .sum{
      position:absolute; left:50%; top:50%;
      transform: translate(-50%,-50%);
      font-size: 16px;
      font-weight: 800;
      letter-spacing: .5px;
      opacity: 0.95;
    }

    .cell.start::after{
      content:"èµ·";
      position:absolute; right:8px; bottom:8px;
      font-size:12px; color: rgba(255,255,255,.85);
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.14);
      padding: 2px 6px; border-radius: 8px;
    }
    .cell.end::after{
      content:"çµ‚";
      position:absolute; right:8px; bottom:8px;
      font-size:12px; color: rgba(255,255,255,.9);
      background: rgba(122,167,255,.22);
      border: 1px solid rgba(122,167,255,.45);
      padding: 2px 6px; border-radius: 8px;
    }
    .cell.hero{
      outline: 3px solid rgba(255,209,102,.75);
      box-shadow: 0 0 0 6px rgba(255,209,102,.12);
    }

    /* controls */
    .btns{ display:flex; flex-wrap:wrap; gap:10px; margin-top: 10px; justify-content:center; }
    button{
      cursor:pointer;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 14px;
      font-weight: 700;
      letter-spacing: .3px;
      transition: transform .05s ease, opacity .2s ease, background .2s ease;
    }
    button:hover{ background: rgba(255,255,255,.10); }
    button:active{ transform: translateY(1px); }
    button:disabled{ opacity:.35; cursor:not-allowed; }

    .side h2{ font-size: 14px; margin: 0 0 10px 0; color: var(--muted); font-weight: 700; }
    .kv{
      display:grid; grid-template-columns: 100px 1fr;
      gap: 8px 10px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.12);
      margin-bottom: 12px;
    }
    .k{ color: var(--muted); }
    .v{ font-weight: 800; }
    .hint{
      font-size: 13px; color: rgba(234,240,255,.85);
      line-height: 1.55;
      border-left: 3px solid rgba(122,167,255,.55);
      padding-left: 10px;
    }
    .log{
      margin-top: 12px;
      padding: 10px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.12);
      height: 170px;
      overflow:auto;
      font-size: 12px;
      color: rgba(234,240,255,.85);
      line-height: 1.5;
      white-space: pre-wrap;
    }
    .mini{
      font-size: 12px;
      color: rgba(234,240,255,.75);
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <h1>é‡‘å¹£è¿·å®®äº’å‹•æ¨¡æ“¬ <span class="tag">7Ã—7ï½œåªèƒ½å‘ä¸Š/å‘å³</span></h1>
      <div id="grid" class="grid" aria-label="coin maze grid"></div>
      <div class="btns">
        <button id="btnRandom">éš¨æ©Ÿï¼ˆæ¯æŒ‰ä¸€æ­¥ï¼‰</button>
        <button id="btnGreedy">è²ªå©ªï¼ˆæ¯æŒ‰ä¸€æ­¥ï¼‰</button>
        <button id="btnReset">é‡ç½®</button>
      </div>
      <div class="mini">åº§æ¨™æ¡ç”¨é¡Œç›®æè¿°ï¼šèµ·é» (1,1) åœ¨å·¦ä¸‹è§’ï¼Œçµ‚é» (7,7) åœ¨å³ä¸Šè§’ã€‚</div>
    </div>

    <div class="side">
      <h2>ç‹€æ…‹é¢æ¿</h2>
      <div class="kv">
        <div class="k">ç›®å‰æ¼”ç®—æ³•</div><div class="v" id="algo">â€”</div>
        <div class="k">ä¸»è§’åº§æ¨™</div><div class="v" id="pos">(1,1)</div>
        <div class="k">ç´¯ç©é‡‘å¹£</div><div class="v" id="sum">0</div>
        <div class="k">æ˜¯å¦åˆ°çµ‚é»</div><div class="v" id="done">å¦</div>
      </div>

      <div class="hint">
        <b>è¦å‰‡ï¼š</b><br/>
        1) æ¯æ ¼é‡‘å¹£ç‚º -3~+3ã€‚<br/>
        2) åªèƒ½å¾€ã€Œå³ã€æˆ–ã€Œä¸Šã€ã€‚<br/>
        3) <b>éš¨æ©Ÿ</b>ï¼šæ¯æ¬¡æŒ‰ä¸‹èµ°ä¸€æ­¥ï¼Œéš¨æ©Ÿé¸å³æˆ–ä¸Šï¼ˆè‹¥å…¶ä¸­ä¸€é‚Šè¶…ç•Œå°±åªèƒ½èµ°å¦ä¸€é‚Šï¼‰ã€‚<br/>
        4) <b>è²ªå©ª</b>ï¼šæ¯æ¬¡æŒ‰ä¸‹èµ°ä¸€æ­¥ï¼Œé¸ç›¸é„°é‡‘å¹£è¼ƒé«˜è€…ï¼ˆå¹³æ‰‹éš¨æ©Ÿï¼‰ã€‚<br/>
      </div>

      <div class="log" id="log"></div>
    </div>
  </div>

  <script>
    // =========================
    // å¯èª¿åƒæ•¸
    // =========================
    const GRID_SIZE = 7;   // è‹¥è¦æ”¹æˆ 8x8ï¼Œæ”¹æˆ 8ï¼Œä¸¦æŠŠ CSS çš„ repeat(7, ...) æ”¹ç‚º repeat(8, ...)
    const MIN_COIN = -3;
    const MAX_COIN =  3;

    // =========================
    // ç‹€æ…‹
    // =========================
    let coins = [];              // coins[y][x]  (0-based)
    let x = 0, y = 0;            // ä¸»è§’ä½ç½® (0,0) = å·¦ä¸‹è§’ (1,1)
    let sum = 0;                 // ç´¯ç©é‡‘å¹£
    let done = false;            // åˆ°çµ‚é»?
    let lastAlgo = "â€”";          // é¡¯ç¤ºç”¨

    // DOM
    const elGrid = document.getElementById("grid");
    const elAlgo = document.getElementById("algo");
    const elPos  = document.getElementById("pos");
    const elSum  = document.getElementById("sum");
    const elDone = document.getElementById("done");
    const elLog  = document.getElementById("log");

    const btnRandom = document.getElementById("btnRandom");
    const btnGreedy = document.getElementById("btnGreedy");
    const btnReset  = document.getElementById("btnReset");

    // =========================
    // å·¥å…·å‡½å¼
    // =========================
    function randInt(a, b){
      return Math.floor(Math.random() * (b - a + 1)) + a;
    }

    function toCoordStr(x0, y0){
      // é¡Œç›®åº§æ¨™ï¼šå·¦ä¸‹è§’æ˜¯ (1,1)
      return `(${x0 + 1},${y0 + 1})`;
    }

    function isEnd(x0, y0){
      return x0 === GRID_SIZE - 1 && y0 === GRID_SIZE - 1;
    }

    function logLine(s){
      elLog.textContent += s + "\n";
      elLog.scrollTop = elLog.scrollHeight;
    }

    // =========================
    // å»ºç«‹åœ°åœ–
    // =========================
    function generateCoins(){
      coins = Array.from({length: GRID_SIZE}, () =>
        Array.from({length: GRID_SIZE}, () => randInt(MIN_COIN, MAX_COIN))
      );
    }

    // =========================
    // ç¹ªè£½æ ¼å­
    // y ç”±ä¸Šåˆ°ä¸‹é¡¯ç¤ºï¼Œä½†æˆ‘å€‘çš„åº§æ¨™ y=0 åœ¨ä¸‹æ–¹
    // =========================
    function render(){
      elGrid.innerHTML = "";

      for(let row = GRID_SIZE - 1; row >= 0; row--){
        for(let col = 0; col < GRID_SIZE; col++){
          const cell = document.createElement("div");
          cell.className = "cell";

          if(col === 0 && row === 0) cell.classList.add("start");
          if(col === GRID_SIZE - 1 && row === GRID_SIZE - 1) cell.classList.add("end");
          if(col === x && row === y) cell.classList.add("hero");

          const coin = document.createElement("div");
          coin.className = "coin";
          const v = coins[row][col];
          coin.textContent = (v > 0 ? `+${v}` : `${v}`);
          if(v > 0) coin.classList.add("good");
          else if(v < 0) coin.classList.add("bad");
          else coin.classList.add("zero");
          cell.appendChild(coin);

          // åªåœ¨ç›®å‰ä½ç½®é¡¯ç¤ºç´¯ç©é‡‘å¹£
          if(col === x && row === y){
            const s = document.createElement("div");
            s.className = "sum";
            s.textContent = sum;
            cell.appendChild(s);
          }

          elGrid.appendChild(cell);
        }
      }

      elAlgo.textContent = lastAlgo;
      elPos.textContent = toCoordStr(x, y);
      elSum.textContent = sum;
      elDone.textContent = done ? "æ˜¯" : "å¦";

      // æŒ‰éˆ•ç‹€æ…‹ï¼šåˆ°çµ‚é»æ‰åœç”¨
      btnRandom.disabled = done;
      btnGreedy.disabled = done;
    }

    // =========================
    // ç§»å‹•ï¼ˆåªèƒ½å³æˆ–ä¸Šï¼‰
    // =========================
    function moveTo(nx, ny, algoName){
      if(done) return false;
      if(nx < 0 || nx >= GRID_SIZE || ny < 0 || ny >= GRID_SIZE) return false;

      const dx = nx - x, dy = ny - y;
      if(!((dx === 1 && dy === 0) || (dx === 0 && dy === 1))) return false;

      lastAlgo = algoName;

      x = nx; y = ny;
      const gain = coins[y][x];
      sum += gain;

      logLine(`[${algoName}] èµ°åˆ° ${toCoordStr(x,y)}ï¼Œæœ¬æ ¼é‡‘å¹£ ${gain>0?`+${gain}`:gain}ï¼Œç´¯ç© = ${sum}`);

      if(isEnd(x,y)){
        done = true;
        logLine(`âœ… åˆ°é”çµ‚é» ${toCoordStr(x,y)}ï¼æœ€çµ‚ç´¯ç©é‡‘å¹£ = ${sum}`);
      }

      render();
      return true;
    }

    // =========================
    // éš¨æ©Ÿï¼šæ¯æŒ‰ä¸€æ­¥ï¼Œéš¨æ©Ÿé¸å³/ä¸Š
    // =========================
    function doRandomOneStep(){
      if(done) return;

      const candidates = [];
      if(x + 1 < GRID_SIZE) candidates.push([x+1, y]); // å³
      if(y + 1 < GRID_SIZE) candidates.push([x, y+1]); // ä¸Š

      if(candidates.length === 0) return;

      const pick = candidates[randInt(0, candidates.length - 1)];
      moveTo(pick[0], pick[1], "éš¨æ©Ÿ");
    }

    // =========================
    // è²ªå©ªï¼šæ¯æŒ‰ä¸€æ­¥ï¼ŒæŒ‘ç›¸é„°é‡‘å¹£è¼ƒé«˜è€…ï¼Œå¹³æ‰‹éš¨æ©Ÿ
    // =========================
    function doGreedyOneStep(){
      if(done) return;

      const options = [];
      if(x + 1 < GRID_SIZE) options.push({nx:x+1, ny:y, dir:"å³", coin: coins[y][x+1]});
      if(y + 1 < GRID_SIZE) options.push({nx:x, ny:y+1, dir:"ä¸Š", coin: coins[y+1][x]});

      if(options.length === 0) return;

      const best = Math.max(...options.map(o => o.coin));
      const bestOptions = options.filter(o => o.coin === best);
      const chosen = bestOptions[randInt(0, bestOptions.length - 1)];

      logLine(`[è²ªå©ª] æ¯”è¼ƒç›¸é„°ï¼š` + options.map(o => `${o.dir}(${o.coin>0?`+${o.coin}`:o.coin})`).join(" vs ")
              + (bestOptions.length > 1 ? " â†’ å¹³æ‰‹éš¨æ©Ÿ" : " â†’ é¸è¼ƒå¤§"));

      moveTo(chosen.nx, chosen.ny, "è²ªå©ª");
    }

    // =========================
    // é‡ç½®
    // =========================
    function resetAll(){
      generateCoins();
      x = 0; y = 0;
      sum = 0;
      done = false;
      lastAlgo = "â€”";
      elLog.textContent = "";
      logLine("ğŸ”„ å·²é‡ç½®ï¼šé‡æ–°ç”¢ç”Ÿåœ°åœ–ï¼Œä¸»è§’å›åˆ° (1,1)ï¼Œç´¯ç©æ­¸é›¶ã€‚");
      render();
    }

    // äº‹ä»¶
    btnRandom.addEventListener("click", doRandomOneStep);
    btnGreedy.addEventListener("click", doGreedyOneStep);
    btnReset.addEventListener("click", resetAll);

    // åˆå§‹åŒ–
    resetAll();
  </script>
</body>
</html>
